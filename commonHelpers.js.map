{"version":3,"file":"commonHelpers.js","sources":["../src/js/basket.js"],"sourcesContent":["const basketList = document.querySelector('.js-basket-list');\nconst totalPriceLabel = document.querySelector('.js-total');\nconst clearBasketBtn = document.querySelector('.clear-cart-btn');\n\nconst LS_KEY = 'clientBasket';\n\nlet currentBasket = JSON.parse(localStorage.getItem(LS_KEY)) ?? [];\n\nif (currentBasket.length) {\n  totalPriceLabel.insertAdjacentHTML(\n    'afterbegin',\n    `Total price = ${getTotalPrice(currentBasket)} грн.\n    Вдалий вибір 👍`\n  );\n  clearBasketBtn.hidden = false;\n} else {\n  totalPriceLabel.insertAdjacentHTML('afterbegin', 'Your basket is empty');\n}\n\nbasketList.insertAdjacentHTML('afterbegin', basketMarkup(currentBasket));\n\nclearBasketBtn.addEventListener('click', clearBasket);\n\nbasketList.addEventListener('click', handlerChangeQuantity);\n\n/**\n * функція для відстеження кнопок зміни кількості одиниць вибраного товару в корзині\n * @param {*} evn\n * @returns\n */\nfunction handlerChangeQuantity(evn) {\n  const currentProduct = evn.target.closest('.cart-item');\n  const currentProductId = Number(currentProduct.dataset.productId);\n  const currentProductIndex = currentBasket.findIndex(\n    ({ id }) => id === currentProductId\n  );\n\n  if (evn.target.nodeName !== 'BUTTON') {\n    return;\n  }\n\n  if (\n    Number(evn.target.dataset.buttonId) === -1 &&\n    currentBasket[currentProductIndex].qnt > 1\n  ) {\n    currentBasket[currentProductIndex].qnt -= 1;\n    changeQuantity();\n  } else if (Number(evn.target.dataset.buttonId) === 1) {\n    currentBasket[currentProductIndex].qnt += 1;\n    changeQuantity();\n  } else if (Number(evn.target.dataset.buttonId) === 0) {\n    removeItem(currentBasket[currentProductIndex]);\n    if (!currentBasket.length) {\n      totalPriceLabel.innerHTML = 'Your basket is empty';\n      clearBasketBtn.hidden = true;\n    }\n  }\n}\n\nfunction changeQuantity() {\n  localStorage.setItem(LS_KEY, JSON.stringify(currentBasket));\n  basketList.innerHTML = basketMarkup(currentBasket);\n  totalPriceLabel.innerHTML = getTotalPrice(currentBasket);\n}\n\nfunction removeItem(idx) {\n  currentBasket.splice(idx, 1);\n  changeQuantity();\n}\n\nfunction clearBasket() {\n  currentBasket = [];\n  localStorage.removeItem(LS_KEY);\n  clearBasketBtn.hidden = true;\n  window.location = '../index.html';\n}\n\nfunction getTotalPrice(arr) {\n  return arr.reduce((acc, { price, qnt }) => {\n    return (acc += price * qnt);\n  }, 0);\n}\n\nfunction basketMarkup(arr) {\n  return arr\n    .map(\n      ({ qnt, price, name, img, id }) => `\n       <li class=\"cart-item\" data-product-id=\"${id}\">\n           <img class=\"product-img\" src=\"${img}\" alt=\"${name}\" />\n           <h2 class=\"product-title\">${name}</h2>\n           <p>Quantity = ${qnt}</p>\n           <p class=\"product-price-cart\">Total price = ${price * qnt} грн</p>\n            <ul class=\"button-list\">\n               <li><button class=\"product-remove-btn\" type=\"button\" data-button-id=\"-1\">-1</button></li>\n               <li><button class=\"product-remove-btn\" type=\"button\" data-button-id='0'>Remove from basket</button></li>\n               <li><button class=\"product-remove-btn\" type=\"button\" data-button-id='1'>+1</button></li>\n            </ul>\n       </li>`\n    )\n    .join('');\n}\n"],"names":["basketList","totalPriceLabel","clearBasketBtn","LS_KEY","currentBasket","getTotalPrice","basketMarkup","clearBasket","handlerChangeQuantity","evn","currentProduct","currentProductId","currentProductIndex","id","changeQuantity","removeItem","idx","arr","acc","price","qnt","name","img"],"mappings":"oCAAA,MAAMA,EAAa,SAAS,cAAc,iBAAiB,EACrDC,EAAkB,SAAS,cAAc,WAAW,EACpDC,EAAiB,SAAS,cAAc,iBAAiB,EAEzDC,EAAS,eAEf,IAAIC,EAAgB,KAAK,MAAM,aAAa,QAAQD,CAAM,CAAC,GAAK,GAE5DC,EAAc,QAChBH,EAAgB,mBACd,aACA,iBAAiBI,EAAcD,CAAa,CAAC;AAAA,oBAEjD,EACEF,EAAe,OAAS,IAExBD,EAAgB,mBAAmB,aAAc,sBAAsB,EAGzED,EAAW,mBAAmB,aAAcM,EAAaF,CAAa,CAAC,EAEvEF,EAAe,iBAAiB,QAASK,CAAW,EAEpDP,EAAW,iBAAiB,QAASQ,CAAqB,EAO1D,SAASA,EAAsBC,EAAK,CAClC,MAAMC,EAAiBD,EAAI,OAAO,QAAQ,YAAY,EAChDE,EAAmB,OAAOD,EAAe,QAAQ,SAAS,EAC1DE,EAAsBR,EAAc,UACxC,CAAC,CAAE,GAAAS,KAASA,IAAOF,CACvB,EAEMF,EAAI,OAAO,WAAa,WAK1B,OAAOA,EAAI,OAAO,QAAQ,QAAQ,IAAM,IACxCL,EAAcQ,CAAmB,EAAE,IAAM,GAEzCR,EAAcQ,CAAmB,EAAE,KAAO,EAC1CE,KACS,OAAOL,EAAI,OAAO,QAAQ,QAAQ,IAAM,GACjDL,EAAcQ,CAAmB,EAAE,KAAO,EAC1CE,KACS,OAAOL,EAAI,OAAO,QAAQ,QAAQ,IAAM,IACjDM,EAAWX,EAAcQ,CAAmB,CAAC,EACxCR,EAAc,SACjBH,EAAgB,UAAY,uBAC5BC,EAAe,OAAS,KAG9B,CAEA,SAASY,GAAiB,CACxB,aAAa,QAAQX,EAAQ,KAAK,UAAUC,CAAa,CAAC,EAC1DJ,EAAW,UAAYM,EAAaF,CAAa,EACjDH,EAAgB,UAAYI,EAAcD,CAAa,CACzD,CAEA,SAASW,EAAWC,EAAK,CACvBZ,EAAc,OAAOY,EAAK,CAAC,EAC3BF,GACF,CAEA,SAASP,GAAc,CACrBH,EAAgB,CAAA,EAChB,aAAa,WAAWD,CAAM,EAC9BD,EAAe,OAAS,GACxB,OAAO,SAAW,eACpB,CAEA,SAASG,EAAcY,EAAK,CAC1B,OAAOA,EAAI,OAAO,CAACC,EAAK,CAAE,MAAAC,EAAO,IAAAC,KACvBF,GAAOC,EAAQC,EACtB,CAAC,CACN,CAEA,SAASd,EAAaW,EAAK,CACzB,OAAOA,EACJ,IACC,CAAC,CAAE,IAAAG,EAAK,MAAAD,EAAO,KAAAE,EAAM,IAAAC,EAAK,GAAAT,CAAE,IAAO;AAAA,gDACOA,CAAE;AAAA,2CACPS,CAAG,UAAUD,CAAI;AAAA,uCACrBA,CAAI;AAAA,2BAChBD,CAAG;AAAA,yDAC2BD,EAAQC,CAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAO/D,EACA,KAAK,EAAE,CACZ"}